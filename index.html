<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabuleiro Interativo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        .tabuleiro {
            display: grid;
            grid-template-columns: repeat(5, 50px);
            grid-gap: 5px;
            justify-content: center;
            margin: 20px auto;
        }
        .quadrado {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            cursor: pointer;
        }
        .quadrado.bomba {
            color: red;
        }
        .quadrado.estrela {
            color: gold;
        }
        button {
            padding: 10px 20px;
            font-size: 1rem;
            margin: 20px;
        }
        #apiResult {
            margin-top: 20px;
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <h1>Tabuleiro Interativo</h1>
    <div id="tabuleiro" class="tabuleiro"></div>
    <button onclick="processLayout()">Enviar para API</button>
    <div id="apiResult"></div>

    <script>
        const tabuleiro = document.getElementById("tabuleiro");
        const apiResult = document.getElementById("apiResult");

        // Inicializa o tabuleiro 5x5 com estrelas
        const layout = Array(5).fill().map(() => Array(5).fill("‚≠ê"));

        // Renderiza o tabuleiro na tela
        function renderTabuleiro() {
            tabuleiro.innerHTML = ""; // Limpa o tabuleiro anterior
            layout.forEach((row, rowIndex) => {
                row.forEach((cell, colIndex) => {
                    const quadrado = document.createElement("div");
                    quadrado.className = `quadrado ${cell === "üí£" ? "bomba" : "estrela"}`;
                    quadrado.textContent = cell;

                    // Alternar estado no clique
                    quadrado.onclick = () => {
                        if (layout[rowIndex][colIndex] === "‚≠ê") {
                            layout[rowIndex][colIndex] = "üí£";
                        } else {
                            layout[rowIndex][colIndex] = "‚≠ê";
                        }
                        renderTabuleiro(); // Re-renderiza o tabuleiro
                    };

                    tabuleiro.appendChild(quadrado);
                });
            });
        }

        // Processa o layout e faz a chamada para a API
        function processLayout() {
            // Converte o layout para a chave ID
            const chaveID = layout
                .flat()
                .map(cell => (cell === "‚≠ê" ? "0" : "1"))
                .join("");

            const apiUrl = `https://hrackmines.github.io/Api/v1/${chaveID}.txt`;

            // Faz a requisi√ß√£o para a API
            fetch(apiUrl)
                .then(response => {
                    if (!response.ok) throw new Error("Erro ao acessar a API.");
                    return response.json();
                })
                .then(data => {
                    renderAPIResult(data);
                })
                .catch(error => {
                    apiResult.textContent = `Erro: ${error.message}`;
                });
        }

        // Exibe o resultado da API em outro tabuleiro
        function renderAPIResult(data) {
            apiResult.innerHTML = "<h2>Resultado da API</h2>";
            const resultTabuleiro = document.createElement("div");
            resultTabuleiro.className = "tabuleiro";

            Object.entries(data).forEach(([key, value]) => {
                const quadrado = document.createElement("div");
                quadrado.className = `quadrado ${value === "true" ? "bomba" : "estrela"}`;
                quadrado.textContent = value === "true" ? "üí£" : "‚≠ê";
                resultTabuleiro.appendChild(quadrado);
            });

            apiResult.appendChild(resultTabuleiro);
        }

        // Inicializa o tabuleiro na tela
        renderTabuleiro();
    </script>
</body>
</html>