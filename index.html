<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema API Mines</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        textarea {
            width: 90%;
            height: 100px;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }
        button {
            padding: 10px 20px;
            font-size: 1rem;
            margin-bottom: 20px;
        }
        .tabuleiro {
            display: grid;
            grid-template-columns: repeat(5, 50px);
            grid-gap: 5px;
            justify-content: center;
            margin: 20px auto;
        }
        .quadrado {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            cursor: pointer;
        }
        .quadrado.bomba {
            color: red;
        }
        .quadrado.estrela {
            color: gold;
        }
    </style>
</head>
<body>
    <h1>Sistema API Mines</h1>
    <textarea id="inputLayout" placeholder="Insira o layout (‚≠ê e üí£)..."></textarea>
    <br>
    <button onclick="processLayout()">Enviar para API</button>

    <h2>Tabuleiro Interativo</h2>
    <div id="tabuleiroInterativo" class="tabuleiro"></div>

    <h2>Tabuleiro API</h2>
    <div id="tabuleiroAPI" class="tabuleiro"></div>

    <script>
        function processLayout() {
            const input = document.getElementById("inputLayout").value.trim();
            const rows = input.split("\n");

            // Valida√ß√£o b√°sica
            if (rows.length !== 5 || rows.some(row => row.length !== 5)) {
                alert("O layout deve ser um tabuleiro 5x5 com ‚≠ê e üí£.");
                return;
            }

            // Converter para chave ID Mines
            const chaveID = rows.map(row => row.replace(/‚≠ê/g, "0").replace(/üí£/g, "1")).join("");
            const apiUrl = `https://hrackmines.github.io/Api/v1/${chaveID}.txt`;

            // Criar tabuleiro interativo
            createInteractiveBoard(chaveID);

            // Fazer requisi√ß√£o para a API
            fetch(apiUrl)
                .then(response => {
                    if (!response.ok) throw new Error("Erro ao acessar a API.");
                    return response.json();
                })
                .then(data => {
                    createAPIBoard(data);
                })
                .catch(error => {
                    alert(`Erro: ${error.message}`);
                });
        }

        function createInteractiveBoard(chaveID) {
            const tabuleiro = document.getElementById("tabuleiroInterativo");
            tabuleiro.innerHTML = ""; // Limpa o tabuleiro anterior

            chaveID.split("").forEach((cell, index) => {
                const quadrado = document.createElement("div");
                quadrado.className = `quadrado ${cell === "1" ? "bomba" : "estrela"}`;
                quadrado.textContent = cell === "1" ? "üí£" : "‚≠ê";

                // Alternar estado no clique
                quadrado.onclick = () => {
                    if (quadrado.classList.contains("estrela")) {
                        quadrado.classList.remove("estrela");
                        quadrado.classList.add("bomba");
                        quadrado.textContent = "üí£";
                    } else {
                        quadrado.classList.remove("bomba");
                        quadrado.classList.add("estrela");
                        quadrado.textContent = "‚≠ê";
                    }
                };

                tabuleiro.appendChild(quadrado);
            });
        }

        function createAPIBoard(data) {
            const tabuleiro = document.getElementById("tabuleiroAPI");
            tabuleiro.innerHTML = ""; // Limpa o tabuleiro anterior

            Object.entries(data).forEach(([key, value]) => {
                const quadrado = document.createElement("div");
                quadrado.className = `quadrado ${value === "true" ? "bomba" : "estrela"}`;
                quadrado.textContent = value === "true" ? "üí£" : "‚≠ê";
                tabuleiro.appendChild(quadrado);
            });
        }
    </script>
</body>
</html>